# Chapter 1. 소프트웨어 변경하기

리팩토링에서 한 걸음 나아가 엉망진창인 코드를 수정하는 방법에 대해 생각해보자. 그러려면 변경의 본질에 대한 고민이 필요하다.

## 소프트웨어를 변경하는 네 가지 이유

1. 기능 추가
2. 버그 수정
3. 설계 개선
4. 최적화

### 기능 추가와 버그 수정

기능 추가는 가장 straightforward 한 종류의 변경인 것처럼 보인다.

어떤 변경이 버그 수정이냐 기능 추가냐 하는 것은 관점에 따라 다르다. 고객의 관점에서는 버그 수정인 변경이 개발자의 관점에서는 기능 추가일 수도 있다.

이런 논란보다 중요한 것은 행위(behavior; 동작?)의 변경이다. 새로운 행위의 추가와 기존 행위의 변경 사이에는 큰 차이가 있다.

프로그래머 다음과 같이 구분할 수도 있다:

- 코드를 수정해야 한다면 행위 변경
- 새로운 코드를 작성하고 이를 호출하기만 한다면 행위 추가

그러나 실제로 기존 행위를 전혀 변경하지 않고 새로운 행위를 추가한다는 것은 불가능하다.

### 설계 개선

리팩토링 - 테스트로 뒷받침되는 일련의 작은 구조적인 수정을 통해 코드를 유지보수하기 쉽게 만들어 간다.

### 최적화

리팩토링 비교

- 공통점 - 동작은 그대로 유지한다.
- 차이점 - 프로그램 구조를 변경하는 대신 성능(resource usage)을 변경한다.

### *Putting It All Together*

일반적으로 코드를 수정하면 다음 세 가지 중 하나 이상이 변화한다: 구조, 기능, 성능

기능 추가, 리팩토링, 최적화는 모두 기존 기능을 변경하지 않는다. 버그 수정의 경우에는 기존 기능을 변경하지만, 대부분의 경우 기존 기능 전체에 비해 극히 일부분만 변경한다.

네 가지 유형의 소프트웨어 변경 모두, 기능 및 행위의 일부를 변화시키지만 그 외의 나머지 기능 및 행위는 보존하는 것이 목표다.

하지만 나머지 행위가 바뀌지 않는다는 것을 알기란 쉽지 않다. 어떤 변경을 가했을 때 그 변경의 여파가 어디까지인지 알 수 없을 때가 많기 때문이다. 알 수 있다면, 영향을 받는 행위에만 집중할 수 있을 것이다.

위험을 줄이기 위해 다음 세 가지 질문을 던져야 한다:

1. 어떤 변경을 가해야 하는가?
2. 그 일을 잘 했다는 것을 어떻게 알 수 있나?
3. 아무 것도 망가뜨리지 않았다는 것을 어떻게 알 수 있나?

내가 같이 일해 본 대부분의 팀들이 매우 보수적인 방식으로 위험을 관리했다. 가능하면 코드에 손을 대지 않으려고 하거나 기존 코드에 조금씩 살을 덧붙여 최소한의 수정으로 위험을 피해보려 한다.

이런 위험을 회피하려 할 때의 문제점은 다음과 같다:

- 새로운 클래스나 메써드를 만들지 않다보면 기존의 것이 점점 거대해지고 이해하기 어려워진다.
    - 좋은 시스템과 나쁜 시스템의 차이:
        - 좋은 시스템은 내용을 파악하고 났을 때 차분해지며, 어느 정도 자신감을 갖고 변경을 가할 수 있다.
        - (구조가) 나쁜 시스템은 내용을 파악한 뒤 변경을 가하려고 할 때, 호랑이를 피하려고 절벽에서 뛰어내리는 듯한 느낌을 갖게 된다.
    - 변경을 가하는 것을 종종 하지 않으면, 실력이 녹슨다.
    - 많은 팀들이 변경에 대해 엄청난 두려움을 가지고 있으며, 이는 나날이 커진다.

지금까지 변경을 회피하는 것이 나쁘다는 것을 이야기했다. 하지만 그 반대는 무엇일까? 단순히 더 열심히 하고 더 많은 인원을 투입하여 변경의 위험을 줄일 수 있는 시간적 여유를 갖는 것인가?

